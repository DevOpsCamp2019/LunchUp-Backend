
Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-credential-initializer-7zwct[0m
{"level":"warn","ts":1573118239.7209144,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/master\" is not a valid GitHub commit ID"}
{"level":"info","ts":1573118239.7214274,"logger":"fallback-logger","caller":"creds-init/main.go:40","msg":"Credentials initialized."}

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-working-dir-initializer-twtwc[0m
{"level":"warn","ts":1573118241.2739525,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: open /var/run/ko/HEAD: no such file or directory"}
{"level":"info","ts":1573118241.3758986,"logger":"fallback-logger","caller":"bash/main.go:65","msg":"Successfully executed command \"mkdir -p /workspace/source\""}

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-place-tools[0m

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-git-source-devopscamp2019-lunchup-backend-7gtlv[0m
{"level":"warn","ts":1573118248.2581458,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/master\" is not a valid GitHub commit ID"}
{"level":"info","ts":1573118249.6379545,"logger":"fallback-logger","caller":"git/git.go:102","msg":"Successfully cloned https://github.com/DevOpsCamp2019/LunchUp-Backend.git @ master in path /workspace/source"}

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-git-merge[0m
Using SHAs from PULL_REFS=master:b181b38bdd0c00c7ba7efd1553738f33e22db819,5:55586109ce5fb7a1d27314e99edfc7d9d4e9beb8
DEBUG: ran git fetch --unshallow origin 55586109ce5fb7a1d27314e99edfc7d9d4e9beb8: b181b38bdd0c00c7ba7efd1553738f33e22db819: in 
DEBUG: ran git checkout master in 
DEBUG: ran git reset --hard b181b38bdd0c00c7ba7efd1553738f33e22db819 in 
DEBUG: ran clean --force -d . in 
DEBUG: ran git merge 55586109ce5fb7a1d27314e99edfc7d9d4e9beb8 in 
Merged SHA 7f2e36e44b938ce0849e2a96a52ac0c1ea9805fc with commit message 'Merge commit '55586109ce5fb7a1d27314e99edfc7d9d4e9beb8'' into base branch master
Merged SHA 55586109ce5fb7a1d27314e99edfc7d9d4e9beb8 with commit message 'add new secret and try to read from it' into base branch master
Merged SHA 9850ff39dc52d1f46557c6cb96a7722a9945a805 with commit message 'Change wrong name' into base branch master
Merged SHA 1dd933d953a114fa8f4ce245c34cb8f3cbb27205 with commit message 'Add postgresql password to deployment.yaml' into base branch master
Merged SHA 8eaf04724065941d5087e06aa231f7879ff12875 with commit message 'add host' into base branch master
Merged SHA 7940f6f7f575c143346f54f8cac08e6452be981d with commit message 'get db password from secret (again 2x)' into base branch master

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-build-container-build[0m
[36mINFO[0m[0000] Downloading base image mcr.microsoft.com/dotnet/core/aspnet:3.0-buster-slim 
ERROR: logging before flag.Parse: E1107 09:17:35.515504      10 metadata.go:142] while reading 'google-dockercfg' metadata: http status code: 404 while fetching url http://metadata.google.internal./computeMetadata/v1/instance/attributes/google-dockercfg
ERROR: logging before flag.Parse: E1107 09:17:35.519325      10 metadata.go:159] while reading 'google-dockercfg-url' metadata: http status code: 404 while fetching url http://metadata.google.internal./computeMetadata/v1/instance/attributes/google-dockercfg-url
2019/11/07 09:17:35 No matching credentials were found, falling back on anonymous
[36mINFO[0m[0001] Error while retrieving image from cache: getting file info: stat /workspace/sha256:803b70d9de2c57a168af4cc7d44e77a9c0591b49ce2af73d50c344aa22048eda: no such file or directory 
[36mINFO[0m[0001] Downloading base image mcr.microsoft.com/dotnet/core/aspnet:3.0-buster-slim 
2019/11/07 09:17:36 No matching credentials were found, falling back on anonymous
[36mINFO[0m[0002] cmd: EXPOSE                                  
[36mINFO[0m[0002] Adding exposed port: 80/tcp                  
[36mINFO[0m[0002] cmd: EXPOSE                                  
[36mINFO[0m[0002] Adding exposed port: 443/tcp                 
[36mINFO[0m[0002] Skipping unpacking as no commands require it. 
[36mINFO[0m[0002] Taking snapshot of full filesystem...        
[36mINFO[0m[0002] ENV COMPlus_EnableDiagnostics=0              
[36mINFO[0m[0002] No files changed in this command, skipping snapshotting. 
[36mINFO[0m[0002] WORKDIR /app                                 
[36mINFO[0m[0002] cmd: workdir                                 
[36mINFO[0m[0002] Changed working directory to /app            
[36mINFO[0m[0002] Creating directory /app                      
[36mINFO[0m[0002] Taking snapshot of files...                  
[36mINFO[0m[0002] EXPOSE 80                                    
[36mINFO[0m[0002] cmd: EXPOSE                                  
[36mINFO[0m[0002] Adding exposed port: 80/tcp                  
[36mINFO[0m[0002] No files changed in this command, skipping snapshotting. 
[36mINFO[0m[0002] EXPOSE 443                                   
[36mINFO[0m[0002] cmd: EXPOSE                                  
[36mINFO[0m[0002] Adding exposed port: 443/tcp                 
[36mINFO[0m[0002] No files changed in this command, skipping snapshotting. 
[36mINFO[0m[0002] Storing source image from stage 0 at path /kaniko/stages/0 
[36mINFO[0m[0020] Deleting filesystem...                       
[36mINFO[0m[0020] Downloading base image mcr.microsoft.com/dotnet/core/sdk:3.0-buster 
2019/11/07 09:17:55 No matching credentials were found, falling back on anonymous
[36mINFO[0m[0020] Error while retrieving image from cache: getting file info: stat /workspace/sha256:65c0187e27b42bc45ea5ef98226c7ef37d1b706e10031ddce377bf6da3dcd9aa: no such file or directory 
[36mINFO[0m[0020] Downloading base image mcr.microsoft.com/dotnet/core/sdk:3.0-buster 
2019/11/07 09:17:56 No matching credentials were found, falling back on anonymous
[36mINFO[0m[0021] Using files from context: [/workspace/source/src/LunchUp.Backend] 
[36mINFO[0m[0021] Checking for cached layer gcr.io/deliverymachine/cache:51fc791bf2dab688df4dff34e3cae61a3c8ca6ebce2089eab358fc347ff64cc7... 
[36mINFO[0m[0022] Using caching version of cmd: RUN dotnet restore "LunchUp.Backend/LunchUp.Backend.sln" 
[36mINFO[0m[0022] Using files from context: [/workspace/source] 
[36mINFO[0m[0022] Checking for cached layer gcr.io/deliverymachine/cache:0c3ff5c78d4b3366586138df93f89bbe98e0ce9198e14ddde77fd548de15f523... 
[36mINFO[0m[0023] No cached layer found for cmd RUN dotnet build "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/build 
[36mINFO[0m[0023] Unpacking rootfs as cmd RUN dotnet build "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/build requires it. 
[36mINFO[0m[0062] Taking snapshot of full filesystem...        
[36mINFO[0m[0070] ENV COMPlus_EnableDiagnostics=0              
[36mINFO[0m[0070] No files changed in this command, skipping snapshotting. 
[36mINFO[0m[0070] WORKDIR /src                                 
[36mINFO[0m[0070] cmd: workdir                                 
[36mINFO[0m[0070] Changed working directory to /src            
[36mINFO[0m[0070] Creating directory /src                      
[36mINFO[0m[0070] Taking snapshot of files...                  
[36mINFO[0m[0070] Using files from context: [/workspace/source/src/LunchUp.Backend] 
[36mINFO[0m[0071] COPY ["src/LunchUp.Backend/", "LunchUp.Backend/"] 
[36mINFO[0m[0071] Taking snapshot of files...                  
[36mINFO[0m[0071] RUN dotnet restore "LunchUp.Backend/LunchUp.Backend.sln" 
[36mINFO[0m[0071] Found cached layer, extracting to filesystem 
[36mINFO[0m[0081] Taking snapshot of files...                  
[36mINFO[0m[0092] Using files from context: [/workspace/source] 
[36mINFO[0m[0096] COPY . .                                     
[36mINFO[0m[0096] Taking snapshot of files...                  
[36mINFO[0m[0096] WORKDIR "/src/LunchUp.Backend"               
[36mINFO[0m[0096] cmd: workdir                                 
[36mINFO[0m[0096] Changed working directory to /src/LunchUp.Backend 
[36mINFO[0m[0096] No files changed in this command, skipping snapshotting. 
[36mINFO[0m[0096] RUN dotnet build "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/build 
[36mINFO[0m[0096] cmd: /bin/sh                                 
[36mINFO[0m[0096] args: [-c dotnet build "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/build] 
Microsoft (R) Build Engine version 16.3.0+0f4c62fea for .NET Core
Copyright (C) Microsoft Corporation. All rights reserved.

  Restore completed in 37.62 ms for /src/LunchUp.Backend/LunchUp.Core/LunchUp.Core.csproj.
  Restore completed in 40.06 ms for /src/LunchUp.Backend/LunchUp.Model/LunchUp.Model.csproj.
  Restore completed in 5.79 ms for /src/LunchUp.Backend/LunchUp.WebHost/LunchUp.WebHost.csproj.
  LunchUp.Model -> /app/build/LunchUp.Model.dll
  LunchUp.Core -> /app/build/LunchUp.Core.dll
  LunchUp.WebHost -> /app/build/LunchUp.WebHost.dll

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:08.32
[36mINFO[0m[0105] Taking snapshot of full filesystem...        
[36mINFO[0m[0110] ignoring socket CoreFxPipe_MSBuild66, not adding to tar 
[36mINFO[0m[0110] ignoring socket dotnet-diagnostic-94-16761834-socket, not adding to tar 
[36mINFO[0m[0110] ignoring socket g+DM1dBf3hsd22AO8JuBabg4ChjyflqwMaiOYpIurSs, not adding to tar 
[36mINFO[0m[0110] ignoring socket dotnet-diagnostic-66-16761518-socket, not adding to tar 
[36mINFO[0m[0111] Pushing layer gcr.io/deliverymachine/cache:0c3ff5c78d4b3366586138df93f89bbe98e0ce9198e14ddde77fd548de15f523 to cache now 
2019/11/07 09:19:31 pushed blob: sha256:0cf10e3001b083ce3ee5ce8d0ca393fa08446bcf8463920cf5e5761751d11ca4
2019/11/07 09:19:34 pushed blob: sha256:53ee56b729b4b5442f25430e2533b3f7fddf62885fce502abb8eac26448ae919
2019/11/07 09:19:35 gcr.io/deliverymachine/cache:0c3ff5c78d4b3366586138df93f89bbe98e0ce9198e14ddde77fd548de15f523: digest: sha256:e69b077940a98f93a8d65e21e68fb697d8dd9c15daf08c62f665f640565b9e9c size: 429
[36mINFO[0m[0120] Storing source image from stage 1 at path /kaniko/stages/1 
[36mINFO[0m[0191] Deleting filesystem...                       
[36mINFO[0m[0193] Base image from previous stage 1 found, using saved tar at path /kaniko/stages/1 
[36mINFO[0m[0195] Checking for cached layer gcr.io/deliverymachine/cache:b234df2d50aefbce2aa0011f758a072bee5c11159d2f94111559cbfa82b0cef3... 
[36mINFO[0m[0196] No cached layer found for cmd RUN dotnet publish "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/publish 
[36mINFO[0m[0196] Unpacking rootfs as cmd RUN dotnet publish "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/publish requires it. 
[36mINFO[0m[0215] Taking snapshot of full filesystem...        
[36mINFO[0m[0228] RUN dotnet publish "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/publish 
[36mINFO[0m[0228] cmd: /bin/sh                                 
[36mINFO[0m[0228] args: [-c dotnet publish "LunchUp.WebHost/LunchUp.WebHost.csproj" -c Release -o /app/publish] 
Microsoft (R) Build Engine version 16.3.0+0f4c62fea for .NET Core
Copyright (C) Microsoft Corporation. All rights reserved.

  Restore completed in 34.67 ms for /src/LunchUp.Backend/LunchUp.Core/LunchUp.Core.csproj.
  Restore completed in 35.19 ms for /src/LunchUp.Backend/LunchUp.Model/LunchUp.Model.csproj.
  Restore completed in 5.47 ms for /src/LunchUp.Backend/LunchUp.WebHost/LunchUp.WebHost.csproj.
  LunchUp.Model -> /src/LunchUp.Backend/LunchUp.Model/bin/Release/netcoreapp3.0/LunchUp.Model.dll
  LunchUp.Core -> /src/LunchUp.Backend/LunchUp.Core/bin/Release/netcoreapp3.0/LunchUp.Core.dll
  LunchUp.WebHost -> /src/LunchUp.Backend/LunchUp.WebHost/bin/Release/netcoreapp3.0/LunchUp.WebHost.dll
  LunchUp.WebHost -> /app/publish/
[36mINFO[0m[0233] Taking snapshot of full filesystem...        
[36mINFO[0m[0238] ignoring socket dotnet-diagnostic-160-16774661-socket, not adding to tar 
[36mINFO[0m[0240] Pushing layer gcr.io/deliverymachine/cache:b234df2d50aefbce2aa0011f758a072bee5c11159d2f94111559cbfa82b0cef3 to cache now 
2019/11/07 09:21:40 pushed blob: sha256:3be926329cc7b4af0089b126839a1f2b9320a76a66c65915acdf6e61f13b73ea
2019/11/07 09:21:44 pushed blob: sha256:54f4d42e63805228f580f97d7056b7385861d11fe6753b9eba22fce3767e4da9
2019/11/07 09:21:45 gcr.io/deliverymachine/cache:b234df2d50aefbce2aa0011f758a072bee5c11159d2f94111559cbfa82b0cef3: digest: sha256:3a96cd1f11eb98e8141ca9c8ffb0e58fb6186eb7acfb5047bef32d5ef1278e55 size: 429
[36mINFO[0m[0249] Storing source image from stage 2 at path /kaniko/stages/2 
[36mINFO[0m[0295] Deleting filesystem...                       
[36mINFO[0m[0305] Base image from previous stage 0 found, using saved tar at path /kaniko/stages/0 
[36mINFO[0m[0307] Skipping unpacking as no commands require it. 
[36mINFO[0m[0307] Taking snapshot of full filesystem...        
[36mINFO[0m[0308] WORKDIR /app                                 
[36mINFO[0m[0308] cmd: workdir                                 
[36mINFO[0m[0308] Changed working directory to /app            
[36mINFO[0m[0308] Creating directory /app                      
[36mINFO[0m[0308] Taking snapshot of files...                  
[36mINFO[0m[0308] COPY --from=publish /app/publish .           
[36mINFO[0m[0308] Taking snapshot of files...                  
[36mINFO[0m[0309] ENTRYPOINT ["dotnet", "LunchUp.WebHost.dll"] 
[36mINFO[0m[0309] No files changed in this command, skipping snapshotting. 
2019/11/07 09:22:45 existing blob: sha256:9526604e089d8d4aa947f34e52a14ac8793232dd181022932f3c15291c5cd3af
2019/11/07 09:22:45 existing blob: sha256:a9e6ceefc5a08dc7b1b04a1105c47e00e9340349177009bc8926571ee8a39204
2019/11/07 09:22:45 existing blob: sha256:8d691f585fa8cec0eba196be460cfaffd69939782d6162986c3e0c5225d54f02
2019/11/07 09:22:45 existing blob: sha256:7a6b64767b0b4ec3bb235712bc93f6cada4812dbfec432d98ca9c485f9ce2ea8
2019/11/07 09:22:45 existing blob: sha256:68f6aee67b9130df079abf2476334ad9474e116c69efedd19e272bbff3643971
2019/11/07 09:22:49 pushed blob: sha256:8fe6c96ed36caef2c8fdf0f8dfb969a71e87c50fb20f36783edc6eef91d6009c
2019/11/07 09:22:49 pushed blob: sha256:09e0417e88703212351617bf2b80a274377a9c0af154494414ecf5d364daabdb
2019/11/07 09:22:49 pushed blob: sha256:916d22ec56a3ad68ba0f24feb3fc235fc19dc722b40fd14ec1f26ef3609fa416
2019/11/07 09:22:52 pushed blob: sha256:29be096fcb1f741173b412124ec615d89310d512dbb7b839b34571c63592bf46
2019/11/07 09:22:54 gcr.io/deliverymachine/lunchup-backend:0.0.0-SNAPSHOT-PR-5-6: digest: sha256:6edbae4ec5cef9b5bd44900d96e70f1f44fa7baf32959febfc7cdf0ac36bd6a8 size: 1572

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-postbuild-post-build[0m
no CVE provider running in the current ** namespace so skip adding image to be analysed

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-promote-make-preview[0m
sed -i -e "s/version:.*/version: 0.0.0-SNAPSHOT-PR-5-6/" Chart.yaml
sed -i -e "s/version:.*/version: 0.0.0-SNAPSHOT-PR-5-6/" ../*/Chart.yaml
sed -i -e "s|repository:.*|repository: gcr.io\/deliverymachine\/lunchup-backend|" values.yaml
sed -i -e "s/tag:.*/tag: 0.0.0-SNAPSHOT-PR-5-6/" values.yaml
sed -i -e "s/tag:.*/tag: 0.0.0-SNAPSHOT-PR-5-6/" values.yaml
pwd
/workspace/source/charts/preview
ls
Chart.yaml
Makefile
requirements.yaml
templates
values.yaml
ls ..
lunchup-backend
preview
echo "  version: 0.0.0-SNAPSHOT-PR-5-6" >> requirements.yaml
** step helm build
WARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080
Adding missing Helm repo: storage.googleapis.com https://storage.googleapis.com/chartmuseum.jenkins-x.io
Successfully added Helm repository storage.googleapis.com.
Adding missing Helm repo: jenkins-x-chartmuseum http://jenkins-x-chartmuseum:8080
Successfully added Helm repository jenkins-x-chartmuseum.
WARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080
Adding missing Helm repo: chartmuseum.jenkins-x.io http://chartmuseum.jenkins-x.io
Successfully added Helm repository chartmuseum.jenkins-x.io.

Showing logs for build [32mdevopscamp2019-lunchup-backend-mhjzp-6[0m stage [32mfrom-build-pack[0m and container [32mstep-promote-jx-preview[0m
Creating a preview
Commit author email is empty for: 7940f6f7f575c143346f54f8cac08e6452be981d
Looking for commits in: /workspace/source/
Commit author email is empty for: 8eaf04724065941d5087e06aa231f7879ff12875
Looking for commits in: /workspace/source/
Commit author email is empty for: 1dd933d953a114fa8f4ce245c34cb8f3cbb27205
Looking for commits in: /workspace/source/
Commit author email is empty for: 9850ff39dc52d1f46557c6cb96a7722a9945a805
Looking for commits in: /workspace/source/
Commit author email is empty for: 55586109ce5fb7a1d27314e99edfc7d9d4e9beb8
Looking for commits in: /workspace/source/
Found commit author match for: valkyrjaa with email address: tuana1998@hotmail.de
expose:
  Annotations:
    helm.sh/hook: post-install,post-upgrade
    helm.sh/hook-delete-policy: hook-succeeded
  config:
    domain: 34.65.166.10.nip.io
    exposer: Ingress
    http: "true"
preview:
  image:
    repository: gcr.io/deliverymachine/LunchUp-Backend
    tag: 0.0.0-SNAPSHOT-PR-5-6
Cloning the Jenkins X versions repo https://github.com/jenkins-x/jenkins-x-versions.git with ref refs/heads/master to /builder/home/.**/jenkins-x-versions
error: Failed to run helm template --name preview --namespace **-devopscamp2019-lunchup-backend-pr-5 . --output-dir /tmp/helm-template-workdir-921902454/preview/output --debug --values /tmp/values.yaml323177636 --values /tmp/values.yaml204577715: failed to run 'helm template --name preview --namespace **-devopscamp2019-lunchup-backend-pr-5 . --output-dir /tmp/helm-template-workdir-921902454/preview/output --debug --values /tmp/values.yaml323177636 --values /tmp/values.yaml204577715' command in directory '', output: 'Error: render error in "preview/charts/db/templates/secrets.yaml": template: preview/charts/db/templates/secrets.yaml:13:55: executing "preview/charts/db/templates/secrets.yaml" at <b64enc>: wrong type for value; expected string; got map[string]interface {}'
[31m
Pipeline failed on stage 'from-build-pack' : container 'step-promote-jx-preview'. The execution of the pipeline has stopped.[0m
